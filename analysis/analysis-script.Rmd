---
title: "Analysis and Visualization Script"
output: github_document
dev: "cairo.pdf"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)
```

## Required Packages 

```{r, message=FALSE}
library(tidyverse)
library(viridis)
library(RColorBrewer)
library(ggpubr)
```

## Data Loading

```{r}
impact_modeling_data <- read.csv("/Users/kenjinchang/github/university-dining-impact-model/data/impact-modeling-data.csv")
```

## Included countries

To distinguish the 123 included countries from within the 135 designated countries within the `world_map_iso` data without available university enrollment and dietary footprint data, we need to construct a new column that can aid with this need,

```{r}
impact_modeling_data %>%
  mutate(inclusion=ifelse(uni_enr_tot>0,country)) %>%
  ggplot(aes(x=long,y=lat,fill=inclusion,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) +
  scale_fill_discrete(h=c(260,260),na.value="white") +
  guides(fill="none") +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  ggtitle("Figure X. Choropleth map highlighting the 123 countries included in our analyses.") +
  theme(legend.position="none",panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank())
```

Comparing university enrollment totals across countries.

```{r}
uni_enr_tot_choro <- ggplot(impact_modeling_data,aes(x=long,y=lat,fill=uni_enr_tot,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) + 
  scale_fill_viridis_c(labels=function(x)x/1000000,name="Millions Enrolled",option="A",trans="reverse",na.value="white",breaks=c(0,6000000,12000000,18000000,24000000,30000000),alpha=0.66) +
  guides(fill=guide_colorbar(reverse=TRUE,title.position="top",title.hjust=0.5)) +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  ggtitle("Enrollment Total") +
  theme(legend.position="bottom",panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank(),legend.key.width=unit(3.5,"cm"))
```
guides(fill=guide_colorbar(reverse=TRUE

  ggtitle("Figure X. Choropleth map comparing university enrollment estimates across the 123 included countries.") +

Comparing university enrollment proportions (university enrollees as a function of the national population) across countries.

```{r}
uni_enr_prop_choro <- ggplot(impact_modeling_data,aes(x=long,y=lat,fill=uni_enr_prop,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) + 
  scale_fill_viridis_c(alpha=0.66,name="Percentage Enrolled",option="A",trans="reverse",na.value="white",labels=scales::percent,breaks=c(0,0.013,0.026,0.039,0.052,0.065)) +
  guides(fill=guide_colorbar(reverse=TRUE,title.position="top",title.hjust=0.5)) +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  ggtitle("Enrollment Proportion") +
  theme(legend.position="bottom",panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank(),legend.key.width=unit(3.5,"cm"))
```


```{r}
ggarrange(uni_enr_tot_choro,uni_enr_prop_choro,
          labels=c("A","B"),
          ncol=1,
          nrow=2)
```

  ggtitle("Figure X. Choropleth map comparing university enrollment estimates as a proportion of their respective national populations across the 123 included countries.") +
  
Comparing per capita baseline carbon footprint (kg co2e) across countries

```{r}
pc_baseline_total_cf_choro <- ggplot(impact_modeling_data,aes(x=long,y=lat,fill=baseline_kg_co2e_total,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) + 
  scale_fill_viridis_c(alpha=0.66,name=bquote('Kilograms CO'[2]*'e'),option="F",trans="reverse",na.value="white",labels=scales::comma,breaks=c(750,1500,2250,3000,3750)) +
  guides(fill=guide_colorbar(reverse=TRUE,title.position="top",title.hjust=0.5)) +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  ggtitle("Diet-Attributable Greenhouse Gas Footprint at Baseline") +
  theme(legend.position="bottom",panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank(),legend.key.width=unit(3.5,"cm"))
```
 
 ggtitle("Figure X. Choropleth map comparing annual per capita dietary greenhouse gas estimates (kg CO2e) at baseline across the 123 included countries.") +
 
Comparing per capita water footprint of baseline diet across countries.

```{r}
pc_baseline_total_wf_choro <- ggplot(impact_modeling_data,aes(x=long,y=lat,fill=baseline_l_blue_green_wf,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) + 
  scale_fill_viridis_c(alpha=0.66,name="Liters",option="G",trans="reverse",na.value="white",labels=scales::comma,breaks=c(750000,1500000,2250000,3000000,3750000)) +
  guides(fill=guide_colorbar(reverse=TRUE,title.position="top",title.hjust=0.5)) +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  ggtitle("Diet-Attributable Water Footprint at Baseline") +
  theme(legend.position="bottom",panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank(),legend.key.width=unit(3.5,"cm"))
```
  
  ggtitle("Figure X. Choropleth map comparing annual per capita dietary water footprint (L) at baseline across the 123 included countries.") +

```{r}
ggarrange(pc_baseline_total_cf_choro,pc_baseline_total_wf_choro,
          labels=c("A","B"),
          ncol=1,
          nrow=2)
```

## Reduction Modeling

In order to examine the mitigation potential associated with each of the explored dietary scenarios, we will need to assemble population-level estimates by multiplying each country's annual per capita baseline estimates against their respective enrollment totals. 

To begin this process, we will first create an accessory dataframe dropping the relevant shapefile and map data.

```{r}
reduction_modeling_data <- read.csv("/Users/kenjinchang/github/university-dining-impact-model/data/impact-modeling-data.csv") %>%
  distinct(country,isced6_enr,isced7_enr,isced8_enr,natpop_est,uni_enr_tot,uni_enr_prop,baseline_kg_co2e_excl_luc,baseline_kg_co2e_total,baseline_l_blue_green_wf,baseline_l_blue_wf_total,baseline_l_green_wf
,meatless_day_kg_co2e_excl_luc,meatless_day_kg_co2e_total,meatless_day_l_blue_green_wf,meatless_day_l_blue_wf_total,meatless_day_l_green_wf,no_dairy_kg_co2e_excl_luc,no_dairy_kg_co2e_total,no_dairy_l_blue_green_wf,no_dairy_l_blue_wf_total,no_dairy_l_green_wf,low_red_meat_kg_co2e_excl_luc,low_red_meat_kg_co2e_total,low_red_meat_l_blue_green_wf,low_red_meat_l_blue_wf_total,low_red_meat_l_green_wf,no_red_meat_kg_co2e_excl_luc,no_red_meat_kg_co2e_total,no_red_meat_l_blue_green_wf,no_red_meat_l_blue_wf_total,no_red_meat_l_green_wf,pescetarian_kg_co2e_excl_luc,pescetarian_kg_co2e_total,pescetarian_l_blue_green_wf,pescetarian_l_blue_wf_total,pescetarian_l_green_wf,lacto_ovo_vegetarian_kg_co2e_excl_luc,lacto_ovo_vegetarian_kg_co2e_total,lacto_ovo_vegetarian_l_blue_green_wf,lacto_ovo_vegetarian_l_blue_wf_total,lacto_ovo_vegetarian_l_green_wf,X2.3_vegan_kg_co2e_excl_luc,X2.3_vegan_kg_co2e_total,X2.3_vegan_l_blue_green_wf,X2.3_vegan_l_blue_wf_total,X2.3_vegan_l_green_wf,vegan_kg_co2e_excl_luc,vegan_kg_co2e_total,vegan_l_blue_green_wf,vegan_l_blue_wf_total,vegan_l_green_wf) %>%
  drop_na()
```

With this complete, we will need to construct 9 new variables: one isolating the per capita carbon footprint attributable to land-use change for each of our dietary scenarios.

```{r}
reduction_modeling_data <- reduction_modeling_data %>% mutate(baseline_kg_co2e_luc=baseline_kg_co2e_total-baseline_kg_co2e_excl_luc) %>%
  mutate(meatless_day_kg_co2e_luc=meatless_day_kg_co2e_total-meatless_day_kg_co2e_excl_luc) %>%
  mutate(no_dairy_kg_co2e_luc=no_dairy_kg_co2e_total-no_dairy_kg_co2e_excl_luc) %>%
  mutate(low_red_meat_kg_co2e_luc=low_red_meat_kg_co2e_total-low_red_meat_kg_co2e_excl_luc) %>%
  mutate(no_red_meat_kg_co2e_luc=no_red_meat_kg_co2e_total-no_red_meat_kg_co2e_excl_luc) %>%
  mutate(pescetarian_kg_co2e_luc=pescetarian_kg_co2e_total-pescetarian_kg_co2e_excl_luc) %>%
  mutate(lacto_ovo_vegetarian_kg_co2e_luc=lacto_ovo_vegetarian_kg_co2e_total-lacto_ovo_vegetarian_kg_co2e_excl_luc) %>%
  mutate(X2.3_vegan_kg_co2e_luc=X2.3_vegan_kg_co2e_total-X2.3_vegan_kg_co2e_excl_luc) %>%
  mutate(vegan_kg_co2e_luc=vegan_kg_co2e_total-vegan_kg_co2e_excl_luc)
```

With these new variables in place, we can generate population-level estimates by scaling each of these per capita estimates according to the university enrollment totals for each country. 

```{r}
reduction_modeling_data <- reduction_modeling_data %>%
  mutate(pop_baseline_kg_co2e_excl_luc=baseline_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_baseline_kg_co2e_total=baseline_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_baseline_kg_co2e_luc=baseline_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_baseline_l_blue_green_wf=baseline_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_baseline_l_blue_wf_total=baseline_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_baseline_l_green_wf=baseline_l_green_wf*uni_enr_tot) %>%
  mutate(pop_meatless_day_kg_co2e_excl_luc=meatless_day_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_meatless_day_kg_co2e_total=meatless_day_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_meatless_day_kg_co2e_luc=meatless_day_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_meatless_day_l_blue_green_wf=meatless_day_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_meatless_day_l_blue_wf_total=meatless_day_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_meatless_day_l_green_wf=meatless_day_l_green_wf*uni_enr_tot) %>%
  mutate(pop_no_dairy_kg_co2e_excl_luc=no_dairy_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_no_dairy_kg_co2e_total=no_dairy_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_no_dairy_kg_co2e_luc=no_dairy_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_no_dairy_l_blue_green_wf=no_dairy_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_no_dairy_l_blue_wf_total=no_dairy_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_no_dairy_l_green_wf=no_dairy_l_green_wf*uni_enr_tot) %>%
  mutate(pop_low_red_meat_kg_co2e_excl_luc=low_red_meat_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_low_red_meat_kg_co2e_total=low_red_meat_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_low_red_meat_kg_co2e_luc=low_red_meat_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_low_red_meat_l_blue_green_wf=low_red_meat_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_low_red_meat_l_blue_wf_total=low_red_meat_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_low_red_meat_l_green_wf=low_red_meat_l_green_wf*uni_enr_tot) %>%
  mutate(pop_no_red_meat_kg_co2e_excl_luc=no_red_meat_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_no_red_meat_kg_co2e_total=no_red_meat_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_no_red_meat_kg_co2e_luc=no_red_meat_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_no_red_meat_l_blue_green_wf=no_red_meat_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_no_red_meat_l_blue_wf_total=no_red_meat_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_no_red_meat_l_green_wf=no_red_meat_l_green_wf*uni_enr_tot) %>%
  mutate(pop_pescetarian_kg_co2e_excl_luc=pescetarian_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_pescetarian_kg_co2e_total=pescetarian_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_pescetarian_kg_co2e_luc=pescetarian_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_pescetarian_l_blue_green_wf=pescetarian_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_pescetarian_l_blue_wf_total=pescetarian_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_pescetarian_l_green_wf=pescetarian_l_green_wf*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_kg_co2e_excl_luc=lacto_ovo_vegetarian_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_kg_co2e_total=lacto_ovo_vegetarian_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_kg_co2e_luc=lacto_ovo_vegetarian_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_l_blue_green_wf=lacto_ovo_vegetarian_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_l_blue_wf_total=lacto_ovo_vegetarian_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_lacto_ovo_vegetarian_l_green_wf=lacto_ovo_vegetarian_l_green_wf*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_kg_co2e_excl_luc=X2.3_vegan_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_kg_co2e_total=X2.3_vegan_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_kg_co2e_luc=X2.3_vegan_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_l_blue_green_wf=X2.3_vegan_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_l_blue_wf_total=X2.3_vegan_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_X2.3_vegan_l_green_wf=X2.3_vegan_l_green_wf*uni_enr_tot) %>%
  mutate(pop_vegan_kg_co2e_excl_luc=vegan_kg_co2e_excl_luc*uni_enr_tot) %>%
  mutate(pop_vegan_kg_co2e_total=vegan_kg_co2e_total*uni_enr_tot) %>%
  mutate(pop_vegan_kg_co2e_luc=vegan_kg_co2e_luc*uni_enr_tot) %>%
  mutate(pop_vegan_l_blue_green_wf=vegan_l_blue_green_wf*uni_enr_tot) %>%
  mutate(pop_vegan_l_blue_wf_total=vegan_l_blue_wf_total*uni_enr_tot) %>%
  mutate(pop_vegan_l_green_wf=vegan_l_green_wf*uni_enr_tot)
```

With these newly constructed population-level estimates, we can now model how each of these indicators would change in response to the proposed dietary scenarios. To do so, we will subtract each of the population-level estimates associated the eight identified dietary scenarios from the corresponding baseline statistic for each country. Seeing as there are six indicators for each of the eight non-baseline scenarios, this should generate a total of 48 new columns. 

```{r}
reduction_modeling_data <- reduction_modeling_data %>% mutate(dec_pop_meatless_day_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_meatless_day_kg_co2e_excl_luc) %>%
  mutate(dec_pop_meatless_day_kg_co2e_total=pop_baseline_kg_co2e_total-pop_meatless_day_kg_co2e_total) %>%
  mutate(dec_pop_meatless_day_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_meatless_day_kg_co2e_luc) %>%
  mutate(dec_pop_meatless_day_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_meatless_day_l_blue_green_wf) %>%
  mutate(dec_pop_meatless_day_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_meatless_day_l_blue_wf_total) %>% 
  mutate(dec_pop_meatless_day_l_green_wf=pop_baseline_l_green_wf-pop_meatless_day_l_green_wf) %>%
  mutate(dec_pop_no_dairy_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_no_dairy_kg_co2e_excl_luc) %>%
  mutate(dec_pop_no_dairy_kg_co2e_total=pop_baseline_kg_co2e_total-pop_no_dairy_kg_co2e_total) %>%
  mutate(dec_pop_no_dairy_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_no_dairy_kg_co2e_luc) %>%
  mutate(dec_pop_no_dairy_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_no_dairy_l_blue_green_wf) %>%
  mutate(dec_pop_no_dairy_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_no_dairy_l_blue_wf_total) %>%
  mutate(dec_pop_no_dairy_l_green_wf=pop_baseline_l_green_wf-pop_no_dairy_l_green_wf) %>%
  mutate(dec_pop_low_red_meat_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_low_red_meat_kg_co2e_excl_luc) %>% 
  mutate(dec_pop_low_red_meat_kg_co2e_total=pop_baseline_kg_co2e_total-pop_low_red_meat_kg_co2e_total) %>%
  mutate(dec_pop_low_red_meat_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_low_red_meat_kg_co2e_luc) %>%
  mutate(dec_pop_low_red_meat_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_low_red_meat_l_blue_green_wf) %>%
  mutate(dec_pop_low_red_meat_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_low_red_meat_l_blue_wf_total) %>%
  mutate(dec_pop_low_red_meat_l_green_wf=pop_baseline_l_green_wf-pop_low_red_meat_l_green_wf) %>%
  mutate(dec_pop_no_red_meat_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_no_red_meat_kg_co2e_excl_luc) %>%
  mutate(dec_pop_no_red_meat_kg_co2e_total=pop_baseline_kg_co2e_total-pop_no_red_meat_kg_co2e_total) %>%
  mutate(dec_pop_no_red_meat_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_no_red_meat_kg_co2e_luc) %>%
  mutate(dec_pop_no_red_meat_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_no_red_meat_l_blue_green_wf) %>%
  mutate(dec_pop_no_red_meat_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_no_red_meat_l_blue_wf_total) %>%
  mutate(dec_pop_no_red_meat_l_green_wf=pop_baseline_l_green_wf-pop_no_red_meat_l_green_wf) %>%
  mutate(dec_pop_pescetarian_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_pescetarian_kg_co2e_excl_luc) %>%
  mutate(dec_pop_pescetarian_kg_co2e_total=pop_baseline_kg_co2e_total-pop_pescetarian_kg_co2e_total) %>%
  mutate(dec_pop_pescetarian_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_pescetarian_kg_co2e_luc) %>%
  mutate(dec_pop_pescetarian_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_pescetarian_l_blue_green_wf) %>%
  mutate(dec_pop_pescetarian_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_pescetarian_l_blue_wf_total) %>%
  mutate(dec_pop_pescetarian_l_green_wf=pop_baseline_l_green_wf-pop_pescetarian_l_green_wf) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_lacto_ovo_vegetarian_kg_co2e_excl_luc) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_kg_co2e_total=pop_baseline_kg_co2e_total-pop_lacto_ovo_vegetarian_kg_co2e_total) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_lacto_ovo_vegetarian_kg_co2e_luc) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_lacto_ovo_vegetarian_l_blue_green_wf) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_lacto_ovo_vegetarian_l_blue_wf_total) %>%
  mutate(dec_pop_lacto_ovo_vegetarian_l_green_wf=pop_baseline_l_green_wf-pop_lacto_ovo_vegetarian_l_green_wf) %>%
  mutate(dec_pop_X2.3_vegan_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_X2.3_vegan_kg_co2e_excl_luc) %>%
  mutate(dec_pop_X2.3_vegan_kg_co2e_total=pop_baseline_kg_co2e_total-pop_X2.3_vegan_kg_co2e_total) %>%
  mutate(dec_pop_X2.3_vegan_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_X2.3_vegan_kg_co2e_luc) %>%
  mutate(dec_pop_X2.3_vegan_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_X2.3_vegan_l_blue_green_wf) %>%
  mutate(dec_pop_X2.3_vegan_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_X2.3_vegan_l_blue_wf_total) %>%
  mutate(dec_pop_X2.3_vegan_l_green_wf=pop_baseline_l_green_wf-pop_X2.3_vegan_l_green_wf) %>%
  mutate(dec_pop_vegan_kg_co2e_excl_luc=pop_baseline_kg_co2e_excl_luc-pop_vegan_kg_co2e_excl_luc) %>%
  mutate(dec_pop_vegan_kg_co2e_total=pop_baseline_kg_co2e_total-pop_vegan_kg_co2e_total) %>%
  mutate(dec_pop_vegan_kg_co2e_luc=pop_baseline_kg_co2e_luc-pop_vegan_kg_co2e_luc) %>%
  mutate(dec_pop_vegan_l_blue_green_wf=pop_baseline_l_blue_green_wf-pop_vegan_l_blue_green_wf) %>%
  mutate(dec_pop_vegan_l_blue_wf_total=pop_baseline_l_blue_wf_total-pop_vegan_l_blue_wf_total) %>%
  mutate(dec_pop_vegan_l_green_wf=pop_baseline_l_green_wf-pop_vegan_l_green_wf) 
```

Now, we will do the same for the percent decrease calculations.

```{r}
reduction_modeling_data <- reduction_modeling_data %>% mutate(perc_dec_pop_meatless_day_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_meatless_day_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_meatless_day_kg_co2e_total=(pop_meatless_day_kg_co2e_total-pop_meatless_day_kg_co2e_total)/pop_meatless_day_kg_co2e_total) %>%
  mutate(perc_dec_pop_meatless_day_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_meatless_day_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_meatless_day_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_meatless_day_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_meatless_day_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_meatless_day_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>% 
  mutate(perc_dec_pop_meatless_day_l_green_wf=(pop_baseline_l_green_wf-pop_meatless_day_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_no_dairy_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_no_dairy_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_no_dairy_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_no_dairy_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_no_dairy_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_no_dairy_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_no_dairy_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_no_dairy_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_no_dairy_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_no_dairy_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_no_dairy_l_green_wf=(pop_baseline_l_green_wf-pop_no_dairy_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_low_red_meat_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_low_red_meat_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>% 
  mutate(perc_dec_pop_low_red_meat_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_low_red_meat_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_low_red_meat_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_low_red_meat_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_low_red_meat_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_low_red_meat_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_low_red_meat_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_low_red_meat_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_low_red_meat_l_green_wf=(pop_baseline_l_green_wf-pop_low_red_meat_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_no_red_meat_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_no_red_meat_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_no_red_meat_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_no_red_meat_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_no_red_meat_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_no_red_meat_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_no_red_meat_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_no_red_meat_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_no_red_meat_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_no_red_meat_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_no_red_meat_l_green_wf=(pop_baseline_l_green_wf-pop_no_red_meat_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_pescetarian_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_pescetarian_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_pescetarian_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_pescetarian_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_pescetarian_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_pescetarian_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_pescetarian_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_pescetarian_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_pescetarian_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_pescetarian_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_pescetarian_l_green_wf=(pop_baseline_l_green_wf-pop_pescetarian_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_lacto_ovo_vegetarian_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_lacto_ovo_vegetarian_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_lacto_ovo_vegetarian_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_lacto_ovo_vegetarian_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_lacto_ovo_vegetarian_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_lacto_ovo_vegetarian_l_green_wf=(pop_baseline_l_green_wf-pop_lacto_ovo_vegetarian_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_X2.3_vegan_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_X2.3_vegan_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_X2.3_vegan_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_X2.3_vegan_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_X2.3_vegan_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_X2.3_vegan_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_X2.3_vegan_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_X2.3_vegan_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_X2.3_vegan_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_X2.3_vegan_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_X2.3_vegan_l_green_wf=(pop_baseline_l_green_wf-pop_X2.3_vegan_l_green_wf)/pop_baseline_l_green_wf) %>%
  mutate(perc_dec_pop_vegan_kg_co2e_excl_luc=(pop_baseline_kg_co2e_excl_luc-pop_vegan_kg_co2e_excl_luc)/pop_baseline_kg_co2e_excl_luc) %>%
  mutate(perc_dec_pop_vegan_kg_co2e_total=(pop_baseline_kg_co2e_total-pop_vegan_kg_co2e_total)/pop_baseline_kg_co2e_total) %>%
  mutate(perc_dec_pop_vegan_kg_co2e_luc=(pop_baseline_kg_co2e_luc-pop_vegan_kg_co2e_luc)/pop_baseline_kg_co2e_luc) %>%
  mutate(perc_dec_pop_vegan_l_blue_green_wf=(pop_baseline_l_blue_green_wf-pop_vegan_l_blue_green_wf)/pop_baseline_l_blue_green_wf) %>%
  mutate(perc_dec_pop_vegan_l_blue_wf_total=(pop_baseline_l_blue_wf_total-pop_vegan_l_blue_wf_total)/pop_baseline_l_blue_wf_total) %>%
  mutate(perc_dec_pop_vegan_l_green_wf=(pop_baseline_l_green_wf-pop_vegan_l_green_wf)/pop_baseline_l_green_wf)
```

Now, per our research questions, we will add economic designations using the World Bank Atlas Method to categorize our 123 countries into 4 groups: low-income countries, lower-middle-income countries, upper-middle-income countries, and high-income countries. We will do so using the classifications provided [here](https://datahelpdesk.worldbank.org/knowledgebase/articles/906519-world-bank-country-and-lending-groups). [Note: Venezuela has been temporarily unclassified in 2021 pending release of revised national accounts statistics but has most recently been designated as an upper-middle-income country.]

```{r}
reduction_modeling_data <- reduction_modeling_data %>%
  mutate(income.classification=case_when(country=="Australia"~"high",country=="Austria"~"high",country=="Barbados"~"high",country=="Belgium"~"high",country=="Bermuda"~"high",country=="Brunei"~"high",country=="Canada"~"high",country=="Chile"~"high",country=="Croatia"~"high",country=="Cyprus"~"high",country=="Czech Republic"~"high",country=="Denmark"~"high",country=="Estonia"~"high",country=="Finland"~"high",country=="France"~"high",country=="Germany"~"high",country=="Greece"~"high",country=="Hong Kong, China"~"high",country=="Hungary"~"high",country=="Iceland"~"high",country=="Ireland"~"high",country=="Israel"~"high",country=="Italy"~"high",country=="Japan"~"high",country=="Kuwait"~"high",country=="Latvia"~"high",country=="Lithuania"~"high",country=="Luxembourg"~"high",country=="Macao, China"~"high",country=="Malta"~"high",country=="Netherlands"~"high",country=="New Zealand"~"high",country=="Norway"~"high",country=="Oman"~"high",country=="Panama"~"high",country=="Poland"~"high",country=="Portugal"~"high",country=="Romania"~"high",country=="Saudi Arabia"~"high",country=="Slovak Republic"~"high",country=="Slovenia"~"high",country=="South Korea"~"high",country=="Spain"~"high",country=="Sweden"~"high",country=="Switzerland"~"high",country=="Taiwan"~"high",country=="United Kingdom"~"high",country=="United States"~"high",country=="Uruguay"~"high",country=="Afghanistan"~"low",country=="Burkina Faso"~"low",country=="Congo, Dem. Rep."~"low",country=="Ethiopia"~"low",country=="Madagascar"~"low",country=="Malawi"~"low",country=="Mali"~"low",country=="Niger"~"low",country=="Rwanda"~"low",country=="Togo"~"low",country=="Uganda"~"low",country=="Yemen"~"low",country=="Algeria"~"lower middle",country=="Benin"~"lower middle",country=="Cambodia"~"lower middle",country=="Cameroon"~"lower middle",country=="Cape Verde"~"lower middle",country=="Cote d'Ivoire"~"lower middle",country=="Egypt"~"lower middle",country=="Ghana"~"lower middle",country=="Honduras"~"lower middle",country=="India"~"lower middle",country=="Iran"~"lower middle",country=="Jordan"~"lower middle",country=="Kenya"~"lower middle",country=="Krygyz Republic"~"lower middle",country=="Lebanon"~"lower middle",country=="Mauritania"~"lower middle",country=="Morocco"~"lower middle",country=="Nepal"~"lower middle",country=="Pakistan"~"lower middle",country=="Philippines"~"lower middle",country=="Senegal"~"lower middle",country=="Sri Lanka"~"lower middle",country=="Tanzania"~"lower middle",country=="Tunisia"~"lower middle",country=="Ukraine"~"lower middle",country=="Zimbabwe"~"lower middle",country=="Albania"~"upper middle",country=="Argentina"~"upper middle",country=="Armenia"~"upper middle",country=="Azerbaijan"~"upper middle",country=="Belarus"~"upper middle",country=="Belize"~"upper middle",country=="Bosnia and Herzegovina"~"upper middle",country=="Botswana"~"upper middle",country=="Brazil"~"upper middle",country=="Bulgaria"~"upper middle",country=="China"~"upper middle",country=="Colombia"~"upper middle",country=="Costa Rica"~"upper middle",country=="Ecuador"~"upper middle",country=="El Salvador"~"upper middle",country=="Fiji"~"upper middle",country=="Georgia"~"upper middle",country=="Guatemala"~"upper middle",country=="Indonesia"~"upper middle",country=="Jamaica"~"upper middle",country=="Kazakhstan"~"upper middle",country=="Malaysia"~"upper middle",country=="Maldives"~"upper middle",country=="Mauritius"~"upper middle",country=="Mexico"~"upper middle",country=="Moldova"~"upper middle",country=="Montenegro"~"upper middle",country=="Namibia"~"upper middle",country=="North Macedonia"~"upper middle",country=="Peru"~"upper middle",country=="Russia"~"upper middle",country=="Serbia"~"upper middle",country=="South Africa"~"upper middle",country=="Thailand"~"upper middle",country=="Turkey"~"upper middle",country=="Venezuela"~"upper middle"))
```

Now, we will use the `count` function to see how many countries fall into each group of observations.

```{r}
reduction_modeling_data %>% group_by(income.classification) %>%
  count("high")
```

After rejoining this new dataframe with our original working dataset (with the shapefile data), we can reconstruct our initial figure - this time designating the included countries according to their income classifications.

```{r}
inclusion_income <- left_join(impact_modeling_data,reduction_modeling_data,by="country") %>% ggplot(aes(x=long,y=lat,fill=income.classification,group=group)) + 
  geom_polygon(color="black",size=0.125,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)","NA"),na.value="white") +
  guides() +
  xlab("") + 
  ylab("") +
  labs(caption="") +
  theme(legend.position="bottom",legend.title=element_blank(),panel.grid=element_blank(),panel.background=element_rect(fill="aliceblue"),panel.border=element_rect(fill=NA),axis.text=element_blank(),axis.ticks=element_blank())
inclusion_income
```

  ggtitle("Figure X. Choropleth map highlighting the 123 countries included in our analyses.") +
  
```{r}
ggsave("figure-1.tiff",device="tiff",plot=inclusion_income,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=100*(14/5),height=70*(14/5))
```

  
Now, we will generate a violin plot array to depict the anticipated population-level reductions in water usage and carbon emissions across the eight proposed dietary scenarios. 

First, we will need to model the potential implications of these changes on diet-attributable climate emissions:

```{r}
vegan_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_vegan_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=dec_pop_vegan_kg_co2e_total),height=0.33,alpha=0.66) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_viridis_c(option="F",name="Kilograms",trans="reverse") +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
vegan_cf_dec_pop_vp
```
 scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +

```{r}
X2.3_vegan_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_X2.3_vegan_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
lacto_ovo_vegetarian_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_lacto_ovo_vegetarian_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
pescetarian_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_pescetarian_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_red_meat_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_red_meat_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
low_red_meat_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_low_red_meat_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_dairy_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_dairy_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
meatless_day_cf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_meatless_day_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-16000000000,-8000000000,0,8000000000,16000000000,24000000000,32000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-17000000000,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

Now, we will generate the a similar array of plots for the estimated population-level reductions in water usage across the same eight scenarios:

```{r}
vegan_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_vegan_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
X2.3_vegan_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_X2.3_vegan_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
lacto_ovo_vegetarian_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_lacto_ovo_vegetarian_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
pescetarian_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_pescetarian_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_red_meat_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_red_meat_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
low_red_meat_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_low_red_meat_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_dairy_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_dairy_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
meatless_day_wf_dec_pop_vp <- ggplot(reduction_modeling_data,aes(x=dec_pop_meatless_day_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-6000000000000,-4000000000000,-2000000000000,0,2000000000000,4000000000000,6000000000000,6000000000000,8000000000000)) +
  geom_vline(xintercept=0,linetype=2,size=0.25) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-7000000000000,8200000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

With these subplots now assigned to our environment generated, we can use the `ggpubr` package's `ggarrange` function to organize these plots into a single visualization for ease of comparison.

```{r}
library(ggpubr)
```

```{r}
pop_dec_cf_wf_vp <- ggarrange(meatless_day_cf_dec_pop_vp,meatless_day_wf_dec_pop_vp,no_dairy_cf_dec_pop_vp,no_dairy_wf_dec_pop_vp,low_red_meat_cf_dec_pop_vp,low_red_meat_wf_dec_pop_vp,no_red_meat_cf_dec_pop_vp,no_red_meat_wf_dec_pop_vp,pescetarian_cf_dec_pop_vp,pescetarian_wf_dec_pop_vp,lacto_ovo_vegetarian_cf_dec_pop_vp,lacto_ovo_vegetarian_wf_dec_pop_vp,X2.3_vegan_cf_dec_pop_vp,X2.3_vegan_wf_dec_pop_vp,vegan_cf_dec_pop_vp,vegan_wf_dec_pop_vp,
          ncol=2,
          nrow=8,
          labels=c("A","B","","","","","","","","","","","","","",""),
          font.label=list(size=14,face="bold",color="black"),
          common.legend=TRUE,
          legend="bottom")
pop_dec_cf_wf_vp
```
%>%
annotate_figure(top=text_grob("Figure X. Violin plot array comparing the anticipated mitigation and savings potential associated with each of the eight modeled dietary scenarios across the four designated income classifications."))

```{r}
ggsave("supp-a.tiff",device="tiff",plot=pop_dec_cf_wf_vp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=75*(14/5),height=150*(14/5))
```


In the interest of exploring the different possible visualization options, we will also generate an array of box plots to see how the aesthetics and presentation of the distributions differ.

As we did last time, we will begin this process by coding the relevant subplots mapping the distributions for the estimated emissions population-level reductions across income classification groups into our environment - this time using box plots. 

```{r}
vegan_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_vegan_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
X2.3_vegan_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_X2.3_vegan_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
lacto_ovo_vegetarian_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_lacto_ovo_vegetarian_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
pescetarian_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_pescetarian_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_red_meat_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_red_meat_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
low_red_meat_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_low_red_meat_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_dairy_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_dairy_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
meatless_day_cf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_meatless_day_kg_co2e_total,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000,breaks=c(-750000000,0,750000000,1500000000,2250000000,3000000000,3750000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-800000000,3800000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

Now, we will proceed by doing the same for the distributions for our water savings estimates across the same lending classifications.

```{r}
vegan_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_vegan_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
X2.3_vegan_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_X2.3_vegan_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
lacto_ovo_vegetarian_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_lacto_ovo_vegetarian_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
pescetarian_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_pescetarian_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_red_meat_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_red_meat_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
low_red_meat_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_low_red_meat_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
no_dairy_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_no_dairy_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
meatless_day_wf_dec_pop_bp <- ggplot(reduction_modeling_data,aes(x=dec_pop_meatless_day_l_blue_green_wf,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000000000,breaks=c(-250000000000,0,250000000000,500000000000,750000000000,1000000000000,1250000000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(-300000000000,1300000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

Again, using the `ggarrange` function of the `ggpubr` package, we will combine these subplots into a single graphic. 

```{r}
pop_dec_cf_wf_bp <- ggarrange(meatless_day_cf_dec_pop_bp,meatless_day_wf_dec_pop_bp,no_dairy_cf_dec_pop_bp,no_dairy_wf_dec_pop_bp,low_red_meat_cf_dec_pop_bp,low_red_meat_wf_dec_pop_bp,no_red_meat_cf_dec_pop_bp,no_red_meat_wf_dec_pop_bp,pescetarian_cf_dec_pop_bp,pescetarian_wf_dec_pop_bp,lacto_ovo_vegetarian_cf_dec_pop_bp,lacto_ovo_vegetarian_wf_dec_pop_bp,X2.3_vegan_cf_dec_pop_bp,X2.3_vegan_wf_dec_pop_bp,vegan_cf_dec_pop_bp,vegan_wf_dec_pop_bp,
          ncol=2,
          nrow=8,
          labels=c("A","B","","","","","","","","","","","","","",""),
          font.label=list(size=14,face="bold",color="black"),
          common.legend=TRUE,
          legend="bottom") 
pop_dec_cf_wf_bp
```

```{r}
ggsave("figure-3.tiff",device="tiff",plot=pop_dec_cf_wf_bp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=75*(14/5),height=150*(14/5))
```

%>%
annotate_figure(top=text_grob("Figure X. Box plot array comparing the anticipated mitigation and savings potential associated with each of the eight modeled dietary scenarios across the four designated income classifications."))

Now, we can make a plot that looks at the most impactful countries across

```{r}
meatless_day_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_meatless_day_kg_co2e_luc,dec_pop_meatless_day_kg_co2e_excl_luc,dec_pop_meatless_day_kg_co2e_total) %>%
  arrange(desc(dec_pop_meatless_day_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_meatless_day_kg_co2e_luc,dec_pop_meatless_day_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=factor(indicator,levels=c("dec_pop_meatless_day_kg_co2e_excl_luc","dec_pop_meatless_day_kg_co2e_luc","dec_pop_meatless_day_l_blue_wf_total","dec_pop_meatless_day_l_green_wf")))) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon","aquamarine4","darkseagreen"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint","Blue Water Footprint","Green Water Footprint"),drop=FALSE) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("Germany","Mexico","Australia","France","Russia","Turkey","Argentina","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
no_dairy_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_no_dairy_kg_co2e_luc,dec_pop_no_dairy_kg_co2e_excl_luc,dec_pop_no_dairy_kg_co2e_total) %>%
  arrange(desc(dec_pop_no_dairy_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_no_dairy_kg_co2e_luc,dec_pop_no_dairy_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("Mexico","France","Germany","Russia","Argentina","Turkey","China","United States","India","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
low_red_meat_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_low_red_meat_kg_co2e_luc,dec_pop_low_red_meat_kg_co2e_excl_luc,dec_pop_low_red_meat_kg_co2e_total) %>%
  arrange(desc(dec_pop_low_red_meat_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_low_red_meat_kg_co2e_luc,dec_pop_low_red_meat_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("Russia","Mexico","Turkey","Germany","France","Australia","China","Argentina","United States","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
no_red_meat_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_no_red_meat_kg_co2e_luc,dec_pop_no_red_meat_kg_co2e_excl_luc,dec_pop_no_red_meat_kg_co2e_total) %>%
  arrange(desc(dec_pop_no_red_meat_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_no_red_meat_kg_co2e_luc,dec_pop_no_red_meat_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("France","United Kingdom","Australia","Chile","Mexico","Russia","Argentina","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
pescetarian_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_pescetarian_kg_co2e_luc,dec_pop_pescetarian_kg_co2e_excl_luc,dec_pop_pescetarian_kg_co2e_total) %>%
  arrange(desc(dec_pop_pescetarian_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_pescetarian_kg_co2e_luc,dec_pop_pescetarian_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("United Kingdom","Turkey","Australia","Chile","Mexico","Russia","Argentina","United States","China","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
lacto_ovo_vegetarian_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_lacto_ovo_vegetarian_kg_co2e_luc,dec_pop_lacto_ovo_vegetarian_kg_co2e_excl_luc,dec_pop_lacto_ovo_vegetarian_kg_co2e_total) %>%
  arrange(desc(dec_pop_lacto_ovo_vegetarian_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_lacto_ovo_vegetarian_kg_co2e_luc,dec_pop_lacto_ovo_vegetarian_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("France","Australia","South Korea","Chile","Mexico","Russia","Argentina","United States","China","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
X2.3_vegan_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_X2.3_vegan_kg_co2e_luc,dec_pop_X2.3_vegan_kg_co2e_excl_luc,dec_pop_X2.3_vegan_kg_co2e_total) %>%
  arrange(desc(dec_pop_X2.3_vegan_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_X2.3_vegan_kg_co2e_luc,dec_pop_X2.3_vegan_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint")) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("Australia","Germany","Mexico","Turkey","Russia","India","Argentina","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +  
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
vegan_cf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_vegan_kg_co2e_luc,dec_pop_vegan_kg_co2e_excl_luc,dec_pop_vegan_kg_co2e_total) %>%
  arrange(desc(dec_pop_vegan_kg_co2e_total)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_vegan_kg_co2e_luc,dec_pop_vegan_kg_co2e_excl_luc),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=factor(indicator,levels=c("dec_pop_vegan_kg_co2e_excl_luc","dec_pop_vegan_kg_co2e_luc","dec_pop_vegan_l_blue_wf_total","dec_pop_vegan_l_green_wf")))) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("tomato","lightsalmon","aquamarine4","darkseagreen"),labels=c("Non-LUC-Attributable Carbon Footprint","LUC-Attributable Carbon Footprint","Blue Water Footprint","Green Water Footprint"),drop=FALSE) +
  scale_x_continuous(breaks=c(0,8000000000,16000000000,24000000000,32000000000),labels=function(x)x/1000000000) +
  scale_y_discrete(limits=c("Germany","Australia","Mexico","Turkey","Russia","Argentina","India","United States","China","Brazil")) +
  coord_cartesian(xlim=c(0,34000000000)) +
  xlab(bquote('Billion Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom")
```

Now, we will do the same for the countries with the largest anticipated water-related dividends.

```{r}
meatless_day_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_meatless_day_l_blue_wf_total,dec_pop_meatless_day_l_green_wf,dec_pop_meatless_day_l_blue_green_wf) %>%
  arrange(desc(dec_pop_meatless_day_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_meatless_day_l_blue_wf_total,dec_pop_meatless_day_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Italy","Iran","Mexico","Argentina","Russia","Egypt","China","Turkey","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Meatless Day") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
no_dairy_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_no_dairy_l_blue_wf_total,dec_pop_no_dairy_l_green_wf,dec_pop_no_dairy_l_blue_green_wf) %>%
  arrange(desc(dec_pop_no_dairy_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_no_dairy_l_blue_wf_total,dec_pop_no_dairy_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Italy","Argentina","Iran","Russia","Egypt","Mexico","China","Turkey","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Dairy") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
low_red_meat_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_low_red_meat_l_blue_wf_total,dec_pop_low_red_meat_l_green_wf,dec_pop_low_red_meat_l_blue_green_wf) %>%
  arrange(desc(dec_pop_low_red_meat_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_low_red_meat_l_blue_wf_total,dec_pop_low_red_meat_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Italy","Australia","Iran","Mexico","Argentina","Egypt","China","Turkey","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Low Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
no_red_meat_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_no_red_meat_l_blue_wf_total,dec_pop_no_red_meat_l_green_wf,dec_pop_no_red_meat_l_blue_green_wf) %>%
  arrange(desc(dec_pop_no_red_meat_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_no_red_meat_l_blue_wf_total,dec_pop_no_red_meat_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("South Korea","Argentina","Australia","Egypt","Mexico","Russia","Turkey","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("No Red Meat") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
pescetarian_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_pescetarian_l_blue_wf_total,dec_pop_pescetarian_l_green_wf,dec_pop_pescetarian_l_blue_green_wf) %>%
  arrange(desc(dec_pop_pescetarian_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_pescetarian_l_blue_wf_total,dec_pop_pescetarian_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("South Korea","Argentina","Iran","Egypt","Mexico","Russia","Turkey","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Pescetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
lacto_ovo_vegetarian_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_lacto_ovo_vegetarian_l_blue_wf_total,dec_pop_lacto_ovo_vegetarian_l_green_wf,dec_pop_lacto_ovo_vegetarian_l_blue_green_wf) %>%
  arrange(desc(dec_pop_lacto_ovo_vegetarian_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_lacto_ovo_vegetarian_l_blue_wf_total,dec_pop_lacto_ovo_vegetarian_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Iran","Argentina","Australia","Mexico","Egypt","Russia","Turkey","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegetarian") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```


```{r}
X2.3_vegan_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_X2.3_vegan_l_blue_wf_total,dec_pop_X2.3_vegan_l_green_wf,dec_pop_X2.3_vegan_l_blue_green_wf) %>%
  arrange(desc(dec_pop_X2.3_vegan_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_X2.3_vegan_l_blue_wf_total,dec_pop_X2.3_vegan_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Australia","Argentina","Iran","Egypt","Mexico","Russia","Turkey","China","United States","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("2/3 Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
vegan_wf_dec_pop_rank <- reduction_modeling_data %>%
  select(country,dec_pop_vegan_l_blue_wf_total,dec_pop_vegan_l_green_wf,dec_pop_vegan_l_blue_green_wf) %>%
  arrange(desc(dec_pop_vegan_l_blue_green_wf)) %>%
  slice(1:10) %>%
  pivot_longer(cols=c(dec_pop_vegan_l_blue_wf_total,dec_pop_vegan_l_green_wf),
               names_to="indicator",
               values_to="value") %>%
  ggplot(aes(x=value,y=country,fill=indicator)) + 
  geom_col(color="black",size=0.25,alpha=0.8) + 
  scale_fill_manual(values=c("aquamarine4","darkseagreen"),labels=c("Blue Water Footprint","Green Water Footprint")) +
  scale_x_continuous(labels=function(x)x/1000000000000) +
  scale_y_discrete(limits=c("Germany","Australia","Iran","Egypt","Mexico","Russia","Turkey","United States","China","Brazil")) +
  coord_cartesian(xlim=c(0,8500000000000)) +
  xlab("Trillion Liters") +
  ylab("") +
  ggtitle("Vegan") +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom")
```


Now, we will aggregate these ranking subplots together.

```{r}
pop_dec_cf_wf_rank <- ggarrange(meatless_day_cf_dec_pop_rank,meatless_day_wf_dec_pop_rank,no_dairy_cf_dec_pop_rank,no_dairy_wf_dec_pop_rank,low_red_meat_cf_dec_pop_rank,low_red_meat_wf_dec_pop_rank,no_red_meat_cf_dec_pop_rank,no_red_meat_wf_dec_pop_rank,pescetarian_cf_dec_pop_rank,pescetarian_wf_dec_pop_rank,lacto_ovo_vegetarian_cf_dec_pop_rank,lacto_ovo_vegetarian_wf_dec_pop_rank,X2.3_vegan_cf_dec_pop_rank,X2.3_vegan_wf_dec_pop_rank,vegan_cf_dec_pop_rank,vegan_wf_dec_pop_rank,
          ncol=2,
          nrow=8,
          labels=c("A","B","","","","","","","","","","","","","",""),
          font.label=list(size=14,face="bold",color="black"),
          common.legend=TRUE,
          legend="bottom") 
pop_dec_cf_wf_rank
```

%>%
annotate_figure(top=text_grob("Figure X. Bar plot array comparing the anticipated mitigation\nand savings potential associated with the 10 most impactful countries\nfor each gross ecological indicator across the eight modeled dietary scenarios."))

```{r}
ggsave("figure-4.tiff",device="tiff",plot=pop_dec_cf_wf_rank,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=100*(14/5),height=160*(14/5))
```

Now, we will generate box and violin plots looking at the distribution of university enrollees across the different income classifications to pair alongside their corresponding choropleths.

kdlsjfkasf;klasjfl; vadspfs
dfaskjdnf
dasf;jdsanfsa
fdsa
fasd
fa
sdf
asd
faf
dsf
das


```{r}
uni_enr_tot_income_classification_bp <- ggplot(reduction_modeling_data,aes(x=uni_enr_tot,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) + 
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000,breaks=c(0,500000,1000000,1500000,2000000,2500000,3000000,3500000,4000000,4500000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,4400000)) +
  xlab("Million Enrollees") +
  ylab("") +
  ggtitle("Enrollment Total") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
uni_enr_tot_income_classification_vp <- ggplot(reduction_modeling_data,aes(x=uni_enr_tot,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=function(x)x/1000000,breaks=c(0,7000000,14000000,21000000,28000000,35000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,34500000)) +
  xlab("Million Enrollees") +
  ylab("") +
  ggtitle("Enrollment Total") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
uni_enr_tot_vp <- ggplot(reduction_modeling_data,aes(x=uni_enr_tot,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=uni_enr_tot),height=0.33,show.legend=FALSE,alpha=0.66) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_viridis_c(option="A",trans="reverse",alpha=0.66) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)"),position="right") +
  scale_x_continuous(labels=function(x)x/1000000,breaks=c(0,7000000,14000000,21000000,28000000,35000000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,34500000)) +
  xlab("Million Enrollees") +
  ylab("") +
  ggtitle("Enrollment Total") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="none")
```

```{r}
uni_enr_prop_income_classification_bp <- ggplot(reduction_modeling_data,aes(x=uni_enr_prop,y=income.classification,fill=income.classification)) + 
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) + 
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=scales::percent,breaks=c(0,0.0075,0.015,0.0225,0.03,0.0375,0.045,0.0525,0.06)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,0.06)) +
  xlab("Proportion Enrolled") +
  ylab("") +
  ggtitle("Enrollment Proportion") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
uni_enr_prop_income_classification_vp <- ggplot(reduction_modeling_data,aes(x=uni_enr_prop,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=income.classification),height=0.33,alpha=0.33) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low")) +
  scale_x_continuous(labels=scales::percent,breaks=c(0,0.015,0.03,0.045,0.06,0.075)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,0.0725)) +
  xlab("Proportion Enrolled") +
  ylab("") +
  ggtitle("Enrollment Proportion") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```

```{r}
uni_enr_prop_vp <- ggplot(reduction_modeling_data,aes(x=uni_enr_prop,y=income.classification,fill=income.classification)) + 
  geom_jitter(aes(color=uni_enr_prop),height=0.33,show.legend=FALSE,alpha=0.66) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_viridis_c(option="A",trans="reverse",alpha=0.66) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)"),position="right") +
  scale_x_continuous(labels=scales::percent,breaks=c(0,0.015,0.03,0.045,0.06,0.075)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,0.0725)) +
  xlab("Proportion Enrolled") +
  ylab("") +
  ggtitle("Enrollment Proportion") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="right")
```

```{r}
uni_enr_prop_choro_vp <- ggarrange(uni_enr_prop_choro,uni_enr_prop_vp,
          ncol=1,
          nrow=2,
          labels=c("C","D"),
          font.label=list(size=14,face="bold",color="black"),
          legend="bottom",
          align="hv",
          heights=c(1,0.4))
```

```{r}
uni_enr_tot_choro_vp <- ggarrange(uni_enr_tot_choro,uni_enr_tot_vp,
          ncol=1,
          nrow=2,
          labels=c("A","B"),
          font.label=list(size=14,face="bold",color="black"),
          legend="bottom",
          align="hv",
          heights=c(1,0.4))
```


```{r}
uni_enr_tot_prop_choro_vp <- ggarrange(uni_enr_tot_choro_vp,uni_enr_prop_choro_vp,
          ncol=2,
          nrow=1)
uni_enr_tot_prop_choro_vp
```

```{r}
ggsave("figure-2.tiff",device="tiff",plot=uni_enr_tot_prop_choro_vp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=200*(14/5),height=90*(14/5))
```

```{r}
uni_enr_tot_prop_choro <- ggarrange(uni_enr_tot_choro,uni_enr_prop_choro,
                            ncol=2,
                            nrow=1,
                            labels=c("A","C"),
                            font.label=list(size=14,face="bold",color="black"),
                            legend="bottom")
```

```{r}
uni_enr_tot_prop_bp <- ggarrange(uni_enr_tot_income_classification_bp,uni_enr_prop_income_classification_bp,
                        ncol=2,
                        nrow=1,
                        labels=c("B","D"),
                        font.label=list(size=14,face="bold",color="black"),
                        legend="bottom",
                        common.legend=TRUE)
```

```{r}
uni_enr_tot_prop_choro_bp <- ggarrange(uni_enr_tot_prop_choro,uni_enr_tot_prop_bp,
                              ncol=1,
                              nrow=2,
                              heights=c(1,0.4))
uni_enr_tot_prop_choro_bp
```

```{r}
ggsave("figure-2-alt.tiff",device="tiff",plot=uni_enr_tot_prop_choro_bp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=200*(14/5),height=95*(14/5))
```

```{r}
pc_baseline_total_cf_vp <- ggplot(reduction_modeling_data,aes(x=baseline_kg_co2e_total,y=income.classification,fill=income.classification)) +
  geom_jitter(aes(color=baseline_kg_co2e_total),height=0.33,show.legend=FALSE,alpha=0.66) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_viridis_c(name="",option="F",na.value="white",labels=scales::comma,trans="reverse") +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)"),position="right") +
  scale_x_continuous(labels=scales::comma) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian() +
  xlab(bquote('Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Diet-Attributable Greenhouse Gas Footprint at Baseline") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="right")
```

```{r}
pc_baseline_total_cf_bp <- ggplot(reduction_modeling_data,aes(x=baseline_kg_co2e_total,y=income.classification,fill=income.classification)) +
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)")) +
  scale_x_continuous(labels=scales::comma,breaks=c(0,300,600,900,1200,1500,1800,2100,2400,2700)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,2750)) +
  xlab(bquote('Kilograms CO'[2]*'e')) +
  ylab("") +
  ggtitle("Diet-Attributable Greenhouse Gas Footprint at Baseline") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.ticks.y=element_blank(),axis.text.y=element_blank())
```


```{r}
pc_baseline_total_wf_vp <- ggplot(reduction_modeling_data,aes(x=baseline_l_blue_green_wf,y=income.classification,fill=income.classification)) +
  geom_jitter(aes(color=baseline_l_blue_green_wf),height=0.33,show.legend=FALSE,alpha=0.66) +
  geom_violin(fill=NA,size=0.25,scale="width",draw_quantiles=0.5,adjust=1,alpha=0.66,trim=TRUE) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_color_viridis_c(name="",option="G",na.value="white",labels=scales::comma,trans="reverse") +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)"),position="right") +
  scale_x_continuous(labels=scales::comma) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian() +
  xlab("Liters") +
  ylab("") +
  ggtitle("Diet-Attributable Water Footprint at Baseline") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="right")
```

```{r}
pc_baseline_total_wf_bp <- ggplot(reduction_modeling_data,aes(x=baseline_l_blue_green_wf,y=income.classification,fill=income.classification)) +
  geom_boxplot(size=0.25,outlier.shape=NA,alpha=0.66) +
  scale_fill_brewer(palette="Set2",limits=c("high","upper middle","lower middle","low"),labels=c("High\n(n=49)","Upper Middle\n(n=36)","Lower Middle\n(n=26)","Low\n(n=12)")) +
  scale_y_discrete(limits=c("high","upper middle","lower middle","low"),labels=c("High (n=49)","Upper Middle (n=36)","Lower Middle (n=26)","Low (n=12)")) +
  scale_x_continuous(labels=scales::comma,breaks=c(0,250000,500000,750000,1000000,1250000,1500000,1750000)) +
  geom_vline(size=0.25,xintercept=0,linetype=2) +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  coord_cartesian(xlim=c(0,1750000)) +
  xlab("Liters") +
  ylab("") +
  ggtitle("Diet-Attributable Water Footprint at Baseline") +
  stat_summary(fun=mean,geom="point",fill="white",shape=21,size=2) +
  theme(panel.background=element_rect(fill="white"),panel.border=element_rect(fill=NA),legend.title=element_blank(),legend.position="bottom",axis.text.y=element_blank(),axis.ticks.y=element_blank())
```


```{r}
pc_baseline_total_cf_choro_vp <- ggarrange(pc_baseline_total_cf_choro,pc_baseline_total_cf_vp,
          ncol=1,
          nrow=2,
          labels=c("A","B"),
          font.label=list(size=14,face="bold",color="black"),
          legend="bottom",
          align="hv",
          heights=c(1,0.4))
```

```{r}
pc_baseline_total_wf_choro_vp <- ggarrange(pc_baseline_total_wf_choro,pc_baseline_total_wf_vp,
          ncol=1,
          nrow=2,
          labels=c("C","D"),
          font.label=list(size=14,face="bold",color="black"),
          legend="bottom",
          align="hv",
          heights=c(1,0.4))
```

```{r}
pc_baseline_total_cf_wf_choro_vp <- ggarrange(pc_baseline_total_cf_choro_vp,pc_baseline_total_wf_choro_vp,
          ncol=2,
          nrow=1)
pc_baseline_total_cf_wf_choro_vp
```

```{r}
ggsave("figure-5.tiff",device="tiff",plot=pc_baseline_total_cf_wf_choro_vp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=200*(14/5),height=90*(14/5))
```


```{r}
pc_baseline_total_cf_wf_choro <- ggarrange(pc_baseline_total_cf_choro,pc_baseline_total_wf_choro,
                                           ncol=2,
                            nrow=1,
                            labels=c("A","C"),
                            font.label=list(size=14,face="bold",color="black"),
                            legend="bottom")
```

```{r}
pc_baseline_total_cf_wf_bp <- ggarrange(pc_baseline_total_cf_bp,pc_baseline_total_wf_bp,
                                        ncol=2,
                        nrow=1,
                        labels=c("B","D"),
                        font.label=list(size=14,face="bold",color="black"),
                        legend="bottom",
                        common.legend=TRUE,
                        align="hv")
```

```{r}
pc_baseline_total_cf_wf_choro_bp <- ggarrange(pc_baseline_total_cf_wf_choro,pc_baseline_total_cf_wf_bp,
                                              ncol=1,
                              nrow=2,
                              align="hv",
                              heights=c(1,0.4))
pc_baseline_total_cf_wf_choro_bp
```

```{r}
ggsave("figure-5-alt.tiff",device="tiff",plot=pc_baseline_total_cf_wf_choro_bp,path=("/Users/kenjinchang/github/university-dining-impact-model/figures/"),dpi=300,units="mm",width=200*(14/5),height=95*(14/5))
```





remember to change out parent dataset so that it includes GNI for scatterplot
